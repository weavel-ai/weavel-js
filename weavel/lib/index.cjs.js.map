{"version":3,"file":"index.cjs.js","sources":["../src/storage.ts","../src/weavel.ts"],"sourcesContent":["import { type WeavelOptions } from \"./types\";\n\nexport type WeavelStorage = {\n  getItem: (key: string) => string | null | undefined;\n  setItem: (key: string, value: string) => void;\n  removeItem: (key: string) => void;\n  clear: () => void;\n  getAllKeys: () => readonly string[];\n};\n\n// Methods partially borrowed from quirksmode.org/js/cookies.html\nexport const cookieStore: WeavelStorage = {\n  getItem(key) {\n    try {\n      const nameEQ = key + \"=\";\n      const ca = document.cookie.split(\";\");\n      for (let i = 0; i < ca.length; i++) {\n        let c = ca[i];\n        while (c.charAt(0) == \" \") {\n          c = c.substring(1, c.length);\n        }\n        if (c.indexOf(nameEQ) === 0) {\n          return decodeURIComponent(c.substring(nameEQ.length, c.length));\n        }\n      }\n    } catch (err) {}\n    return null;\n  },\n\n  setItem(key: string, value: string) {\n    try {\n      const cdomain = \"\",\n        expires = \"\",\n        secure = \"\";\n\n      const new_cookie_val = key + \"=\" + encodeURIComponent(value) + expires + \"; path=/\" + cdomain + secure;\n      document.cookie = new_cookie_val;\n    } catch (err) {\n      return;\n    }\n  },\n\n  removeItem(name) {\n    try {\n      cookieStore.setItem(name, \"\");\n    } catch (err) {\n      return;\n    }\n  },\n  clear() {\n    document.cookie = \"\";\n  },\n  getAllKeys() {\n    const ca = document.cookie.split(\";\");\n    const keys = [];\n\n    for (let i = 0; i < ca.length; i++) {\n      let c = ca[i];\n      while (c.charAt(0) == \" \") {\n        c = c.substring(1, c.length);\n      }\n      keys.push(c.split(\"=\")[0]);\n    }\n\n    return keys;\n  },\n};\n\nconst createStorageLike = (store: any): WeavelStorage => {\n  return {\n    getItem(key) {\n      return store.getItem(key);\n    },\n\n    setItem(key, value) {\n      store.setItem(key, value);\n    },\n\n    removeItem(key) {\n      store.removeItem(key);\n    },\n    clear() {\n      store.clear();\n    },\n    getAllKeys() {\n      const keys = [];\n      for (const key in localStorage) {\n        keys.push(key);\n      }\n      return keys;\n    },\n  };\n};\n\nconst checkStoreIsSupported = (storage: WeavelStorage, key = \"__mplssupport__\"): boolean => {\n  if (!window) {\n    return false;\n  }\n  try {\n    const val = \"xyz\";\n    storage.setItem(key, val);\n    if (storage.getItem(key) !== val) {\n      return false;\n    }\n    storage.removeItem(key);\n    return true;\n  } catch (err) {\n    return false;\n  }\n};\n\nlet localStore: WeavelStorage | undefined = undefined;\nlet sessionStore: WeavelStorage | undefined = undefined;\n\nconst createMemoryStorage = (): WeavelStorage => {\n  const _cache: { [key: string]: any | undefined } = {};\n\n  const store: WeavelStorage = {\n    getItem(key) {\n      return _cache[key];\n    },\n\n    setItem(key, value) {\n      _cache[key] = value !== null ? value : undefined;\n    },\n\n    removeItem(key) {\n      delete _cache[key];\n    },\n    clear() {\n      for (const key in _cache) {\n        delete _cache[key];\n      }\n    },\n    getAllKeys() {\n      const keys = [];\n      for (const key in _cache) {\n        keys.push(key);\n      }\n      return keys;\n    },\n  };\n  return store;\n};\n\nexport const getStorage = (type: WeavelOptions[\"persistence\"], window: Window | undefined): WeavelStorage => {\n  if (typeof window !== undefined && window) {\n    if (!localStorage) {\n      const _localStore = createStorageLike(window.localStorage);\n      localStore = checkStoreIsSupported(_localStore) ? _localStore : undefined;\n    }\n\n    if (!sessionStore) {\n      const _sessionStore = createStorageLike(window.sessionStorage);\n      sessionStore = checkStoreIsSupported(_sessionStore) ? _sessionStore : undefined;\n    }\n  }\n\n  switch (type) {\n    case \"cookie\":\n      return cookieStore || localStore || sessionStore || createMemoryStorage();\n    case \"localStorage\":\n      return localStore || sessionStore || createMemoryStorage();\n    case \"sessionStorage\":\n      return sessionStore || createMemoryStorage();\n    case \"memory\":\n      return createMemoryStorage();\n    default:\n      return createMemoryStorage();\n  }\n};\n","import {\n  WeavelCore,\n  WeavelWebStateless,\n  type WeavelFetchOptions,\n  type WeavelFetchResponse,\n  type WeavelPersistedProperty,\n  utils,\n} from \"weavel-core\";\nimport { type WeavelStorage, getStorage } from \"./storage\";\nimport { version } from \"../package.json\";\nimport { type WeavelOptions } from \"./types\";\n\n// Required when users pass these as typed arguments\nexport {\n  type WeavelTraceClient,\n  type WeavelSpanClient,\n  type WeavelGenerationClient,\n} from \"weavel-core\";\n\nexport class Weavel extends WeavelCore {\n  private _storage: WeavelStorage;\n  private _storageCache: any;\n  private _storageKey: string;\n\n  constructor(params?: { apiKey?: string;  } & WeavelOptions) {\n    const weavelConfig = utils.configWeavelSDK(params);\n    super(weavelConfig);\n\n    if (typeof window !== \"undefined\" && \"Deno\" in window === false) {\n      this._storageKey = params?.persistence_name\n        ? `lf_${params.persistence_name}`\n        : `lf_${weavelConfig.apiKey}_weavel`;\n      this._storage = getStorage(params?.persistence || \"localStorage\", window);\n    } else {\n      this._storageKey = `lf_${weavelConfig.apiKey}_weavel`;\n      this._storage = getStorage(\"memory\", undefined);\n    }\n  }\n\n  getPersistedProperty<T>(key: WeavelPersistedProperty): T | undefined {\n    if (!this._storageCache) {\n      this._storageCache = JSON.parse(this._storage.getItem(this._storageKey) || \"{}\") || {};\n    }\n\n    return this._storageCache[key];\n  }\n\n  setPersistedProperty<T>(key: WeavelPersistedProperty, value: T | null): void {\n    if (!this._storageCache) {\n      this._storageCache = JSON.parse(this._storage.getItem(this._storageKey) || \"{}\") || {};\n    }\n\n    if (value === null) {\n      delete this._storageCache[key];\n    } else {\n      this._storageCache[key] = value;\n    }\n\n    this._storage.setItem(this._storageKey, JSON.stringify(this._storageCache));\n  }\n\n  fetch(url: string, options: WeavelFetchOptions): Promise<WeavelFetchResponse> {\n    return fetch(url, options);\n  }\n\n  getLibraryId(): string {\n    return \"weavel\";\n  }\n\n  getLibraryVersion(): string {\n    return version;\n  }\n\n  getCustomUserAgent(): void {\n    return;\n  }\n}\n\nexport class WeavelWeb extends WeavelWebStateless {\n  private _storage: WeavelStorage;\n  private _storageCache: any;\n  private _storageKey: string;\n\n  constructor(params?: WeavelOptions) {\n    const weavelConfig = utils.configWeavelSDK(params);\n    super(weavelConfig);\n\n    if (typeof window !== \"undefined\") {\n      this._storageKey = params?.persistence_name\n        ? `lf_${params.persistence_name}`\n        : `lf_${weavelConfig.apiKey}_weavel`;\n      this._storage = getStorage(params?.persistence || \"localStorage\", window);\n    } else {\n      this._storageKey = `lf_${weavelConfig.apiKey}_weavel`;\n      this._storage = getStorage(\"memory\", undefined);\n    }\n  }\n\n  getPersistedProperty<T>(key: WeavelPersistedProperty): T | undefined {\n    if (!this._storageCache) {\n      this._storageCache = JSON.parse(this._storage.getItem(this._storageKey) || \"{}\") || {};\n    }\n\n    return this._storageCache[key];\n  }\n\n  setPersistedProperty<T>(key: WeavelPersistedProperty, value: T | null): void {\n    if (!this._storageCache) {\n      this._storageCache = JSON.parse(this._storage.getItem(this._storageKey) || \"{}\") || {};\n    }\n\n    if (value === null) {\n      delete this._storageCache[key];\n    } else {\n      this._storageCache[key] = value;\n    }\n\n    this._storage.setItem(this._storageKey, JSON.stringify(this._storageCache));\n  }\n\n  fetch(url: string, options: WeavelFetchOptions): Promise<WeavelFetchResponse> {\n    return fetch(url, options);\n  }\n\n  getLibraryId(): string {\n    return \"weavel-frontend\";\n  }\n\n  getLibraryVersion(): string {\n    return version;\n  }\n\n  getCustomUserAgent(): void {\n    return;\n  }\n}\n"],"names":["cookieStore","getItem","key","nameEQ","ca","document","cookie","split","i","length","c","charAt","substring","indexOf","decodeURIComponent","err","setItem","value","cdomain","expires","secure","new_cookie_val","encodeURIComponent","removeItem","name","clear","getAllKeys","keys","push","createStorageLike","store","localStorage","checkStoreIsSupported","storage","window","val","localStore","undefined","sessionStore","createMemoryStorage","_cache","getStorage","type","_localStore","_sessionStore","sessionStorage","Weavel","WeavelCore","constructor","params","weavelConfig","utils","configWeavelSDK","_storageKey","persistence_name","apiKey","_storage","persistence","getPersistedProperty","_storageCache","JSON","parse","setPersistedProperty","stringify","fetch","url","options","getLibraryId","getLibraryVersion","version","getCustomUserAgent","WeavelWeb","WeavelWebStateless"],"mappings":"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"}